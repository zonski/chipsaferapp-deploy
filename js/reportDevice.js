var app,columns,dataFields,report="device",filtered=!1,setup={backgroundline:"rgb(255, 153, 153)",populateSelect:function(){},bindActions:function(){$(".report-action").click(function(){switch($(this).data("action")){case"filter":entryUtil.validateFields("#report-filter")&&(reportUtil.tableLoad(!1),setup.drawSpecialLine(),dataFields=entryUtil.buildEntryJson("#report-filter"));break;case"clear":reportUtil.clearFilters();break;default:console.log("Report Action UNDEFINED")}}),$("body").on("focus","#startDate",function(){$(this).datetimepicker({timeFormat:"HH:mm:ss"})}),$("body").on("focus","#endDate",function(){$(this).datetimepicker({timeFormat:"HH:mm:ss"})}),$("#periodOption").on("change",function(e){setup.renderPeriodDiv($("#periodOption").val())})},renderPeriodDiv:function(e){2==e?$("#period-div").removeClass("d-none"):$("#period-div").addClass("d-none")},bindTableActions:function(){$(".table-action").click(function(){switch($(this).data("action")){case"animalMovement":$("#animalMovement").modal("show"),$("#id").val($(this).data("id"));break;case"animalWeighing":$("#id").val($(this).data("id")),window.location.href="chartAnimalWeighing.html?id="+$("#id").val();break;default:console.log("Table Action UNDEFINED")}})},reportInXlsPDF:function(e){property=localStorage.getItem("property_id"),periodOption=$("#periodOption").val(),hlInactiveDevices=document.getElementById("highlightInactiveDevices").checked,inactiveDays=""==$("#inactiveDays").val()?null:$("#inactiveDays").val(),startDate=""==$("#startDate").val()?null:$("#startDate").val().replace(/(\/)/g,"-"),endDate=""==$("#endDate").val()?null:$("#endDate").val().replace(/(\/)/g,"-"),window.location=app.api+"api/devicereport/reportoutput/"+app.locale+"/"+e+"/"+periodOption+"/"+hlInactiveDevices+"/"+inactiveDays+"/"+startDate+"/"+endDate+"/"+property},bindModalActions:function(){$("#btn-cancel").click(function(){$("#animalMovement input").val("")}),$("#btn-ok").click(function(){entryUtil.validateFields("#animalMovement")&&(window.location.href="chartAnimalMovement.html?id="+$("#id").val()+"&dateFrom="+$("#dateFrom").val()+"&dateTo="+$("#dateTo").val())})},tableSetup:function(){columns=[{data:"device.code",responsivePriority:1,render:function(e){return e?app.htmlEncode(e):"-"}},{data:"animalName",responsivePriority:2,render:function(e){return e?app.htmlEncode(e):"-"}},{data:"coordinate.x",responsivePriority:2,render:function(e){return e?app.htmlEncode(e):"-"}},{data:"coordinate.y",responsivePriority:3,render:function(e){return e?app.htmlEncode(e):"-"}},{data:"batteryPercentage",responsivePriority:1,render:function(e){return e?app.htmlEncode(e+"%"):"-"}},{data:"lastDataReceived",responsivePriority:1,render:function(e){return e?app.htmlEncode(app.getDateTime(e,"DD/MM/YYYY HH:mm:ss")):"-"}},{data:"timeWithoutData",responsivePriority:1,render:function(e){return e?app.htmlEncode(e):"-"}}]},drawSpecialLine:function(){setTimeout(function(){var e=void 0;$.each(reportUtil.data,function(t,i){i&&i.changeColor&&(e=$("#report-table").find('tr[role="row"]'),void 0,$.each(e,function(e,t){var a=$(t).find("td")[1];a&&$(a).html()==i.animalName&&$(t)&&$(t).css("background-color",setup.backgroundline)}))})},2e3)},init:function(e){console.log("reportDevice.js"),document.title=$.t("report.device.lastData.title"),app=e,reportUtil.fnDrawCallback=setup.drawSpecialLine,setup.populateSelect(),setup.bindActions(),setup.tableSetup(),setup.bindModalActions()}};