var app,table,entry="supplement",listMultiselect=[],setup={bindActions:function(){$(".entry-action").click(function(){switch($(this).data("action")){case"addOpen":case"addCancel":render.switchTop();break;case"submit":entryUtil.validateFields()&&entryUtil.entryCrud(entry,"submit");break;case"selectIngredients":$("#multiselect-modal").modal("show");break;default:console.log("Entry Action UNDEFINED")}})},bindTableActions:function(){$(".table-action").click(function(){switch($(this).data("action")){case"edit":entryUtil.entryCrud(entry,"get",$(this).data("id"));break;case"delete":var e=$(this).data("id");app.notify("warning",$.t("notify.warning"),$.t("entry.deleteConfirm",{entry:$.t(entry+".name")}),!0,function(t){t&&entryUtil.entryCrud(entry,"delete",e)});break;default:console.log("Table Action UNDEFINED")}})},bindModalActions:function(){$("#btn-cancel").click(function(){var e=$("#id").val();$("#multiselect-modal").modal("hide"),$('#multiselect-modal input[type="checkbox"]').prop("checked",!1),e&&$.each(listMultiselect,function(){$('#multiselect-modal input[type="checkbox"][data-value="'+this.id+'"]').prop("checked",!0)})}),$("#multiselect-modal").on("hidden.bs.modal",function(){entryUtil.cleanFilter()}),$("#btn-confirm").click(function(){var e=$("#multiselect-modal input[type='search']").val();$("#multiselect-table").DataTable().search("").draw(),$('#multiselect-modal input[type="text"]').removeClass("field-error");var t=0,n=!0;return $('#multiselect-modal input[type="checkbox"]:checked').each(function(){var e=$(this).next(),a=e.attr("min"),r=e.attr("max"),i=e.val(),l=parseFloat(i.replace(".","").replace(",","."));isNaN(l)?($(e).addClass("field-error"),n=!1):t=(parseFloat(t)+l).toFixed(12),(!/^-?[0-9]?\d*(\,\d+)?$/.test(i)||a&&l<parseFloat(a)||r&&l>parseFloat(r))&&($(e).addClass("field-error"),n=!1)}),n?100!=t&&(app.notify("error",$.t("notify.error"),$.t("ingredient.percentageError"),!1),n=!1):app.notify("error",$.t("notify.error"),$.t("error.numberError"),!1,void 0),$("#multiselect-table").DataTable().search(e).draw(),n})},tableSetup:function(){entryUtil.multiselectLoad("ingredient",[{data:null,render:function(e){return'<div class="checkbox"><label class="stations-label break-line"><input type="checkbox" class="station-check" data-name="id" data-value="'+e.id+'" value="'+e.id+'"><input type="text" class="form-control field number text-percentage" data-attribute="percentage" data-name="id" data-value="'+e.id+'" max="100" min="0">'+e.name+"</label></div>"}}]);var e=[{data:"name",render:function(e){return e?app.htmlEncode(e):"-"}},{data:"id",className:"hide",render:function(e){return app.htmlEncode(e)}},{data:"supplementType.name",render:function(e){return e?app.htmlEncode(e):"-"}},{data:"productBrand",render:function(e){return e?app.htmlEncode(e):"-"}},{data:"expectedConsumption",render:function(e){return e?app.htmlEncode(e)+" "+$.t("supplement.measure.ganimalday"):"-"}},{data:"expectedWeightGain",render:function(e){return e?app.htmlEncode(e)+" "+$.t("supplement.measure.ganimalday"):"-"}},{data:"weight",render:function(e){return e?app.htmlEncode(e)+" "+$.t("supplement.measure.kg"):"-"}},{data:"averageCost",render:function(e){return e?$.t("supplement.measure.money")+" "+app.htmlEncode(e):"-"}},{data:"ingredientConcat",className:"none",render:function(e){return e?app.htmlEncode(e):"-"}},{data:null,render:function(e){return render.renderActions(e.id,e.id,e.locked)}}];entryUtil.tableLoad(e,!1)},populateSelects:function(){entryUtil.populateSelect("supplementType",["name"],!1)},init:function(e){console.log("entrySupplement.js"),app=e,this.bindActions(),this.populateSelects(),this.tableSetup(),this.bindModalActions()}};