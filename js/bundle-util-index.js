function initPage(){var e={index:function(e){setup.init(e)},propertyMenu:function(e){setup.init(e)},termConditions:function(e){setup.init(e)},dashboard:function(e){setup.init(e)},home:function(e){setup.init(e)},taskEvent:function(e){setup.init(e)},taskEventView:function(e){setup.init(e)},report:function(e){setup.init(e)},propertyMap:function(e){setup.init(e)},lotAnimals:function(e){setup.init(e)},entry:function(e){setup.init(e),entryUtil.handleNumber()}},t={api:"",action:$("body").attr("data-page"),alertTable:"",locale:localStorage.getItem("i18n")||navigator.language,notifications:"undefined"==typeof notifyComponent?null:new notifyComponent,tasks:"undefined"==typeof taskComponent?null:new taskComponent,changePage:function(e){switch(e){case"buyAnimals":case"saleAnimals":case"slaughterSale":null!=localStorage.getItem("transactionId")&&localStorage.removeItem("transactionId")}window.location=e+".html"},setPath:function(){$.ajax(window.location.origin+"/json/frontconfig.dev.json").done(function(a){t.api=a.api,"index"!==t.action?t.isLogged():e[t.action](t)})},isLogged:function(){localStorage.getItem("access_token")||t.logout(),localStorage.getItem("property_id")||"/propertyMenu.html"==window.location.pathname||(window.location.href="propertyMenu.html"),e[t.action](t),t.setPage()},setPage:function(){t.setPartials()},setPartials:function(){$.when($("#sidebar").load(window.location.origin+"/sidebar.html",function(){})).done(function(){$("#navbar").load(window.location.origin+"/navbar.html",function(){t.getRoles(),$.i18n&&$("body").localize(),t.bindLogout(),$("#property-name").html(localStorage.getItem("property_name")+" "),t.isMobile()&&$("#navbar-logo").attr("href","taskEvent.html"),"1"==localStorage.getItem("profile_id")?($('a[data-i18n="menu.setup.user-list-menu"]').parent().show(),$('a[data-i18n="menu.setup.user-menu"]').parent().hide()):($('a[data-i18n="menu.setup.user-list-menu"]').parent().hide(),$('a[data-i18n="menu.setup.user-menu"]').parent().show()),t.notifications.init(),t.adjustScreen(),$('[data-toggle="tooltip"]').tooltip(),$("#alert-modal .modal-footer button").click(function(){$("#alert-modal").modal("hide")}),t.setTaskWindow(),t.setChangePwd(),$("#translate a").click(function(){localStorage.setItem("i18n",$(this).data("value")),window.location.reload()}),$('#translate a[data-value="'+t.locale+'"]').parent().addClass("active"),$("#setupBox").find("a").css("filter","grayscale(100%)"),$("#setupBox").find("a[data-value='"+t.locale+"']").css("filter",""),$("#setupBox .property-name").html(localStorage.getItem("property_name")+" "),$(".tooltip-chipsafer").parent().tooltip({show:null,position:{my:"left top",at:"left bottom"},using:function(e,t){$(this).css(e),$("<div>").addClass("arrow").addClass(t.vertical).addClass(t.horizontal).appendTo(this)},open:function(e,t){t.tooltip.animate({top:t.tooltip.position().top+10},"fast")}}),sidebarBuilder.getMenuItens().then(e=>{e.forEach(e=>{$("#sidebar-content").append(e)})})})}),$(window).resize(function(){t.adjustScreen()})},setChangePwd:function(){$("#open-change-pwd-modal").click(function(e){$("#change-pwd-modal").modal("show")}),$("#btn-close-change-pwd").click(function(){$("#change-pwd-modal").modal("hide"),$("#currentPassword").val(""),$("#newPassword").val(""),$("#confirmPassword").val("")}),$("#currentPassword").focusout(function(){""!==$(this).val()&&$(this).removeClass("field-error")}),$("#newPassword").focusout(function(){""!==$(this).val()&&$(this).removeClass("field-error")}),$("#confirmPassword").focusout(function(){""!==$(this).val()&&$(this).removeClass("field-error")}),$("#btn-save-change-pwd").click(function(){var e=!0;if($("#change-pwd-fields input[type='password']").each(function(){val=$(this).val(),trimval=val.trim(),!$(this).hasClass("required")||val&&trimval?$(this).removeClass("field-error"):($(this).addClass("field-error"),e&&(e=!1,$.t("error.requiredError")))}),e){t.loadingAdd();var a=entryUtil.buildEntryJson("#changePasswordForm"),o=$.t("user.passwordChangeSuccess");$.ajax({url:t.api+"api/user/changepwd",type:"POST",data:JSON.stringify(a),contentType:"application/json; charset=utf-8",beforeSend:t.setHeaders}).done(function(e){t.notify("success",$.t("notify.success"),o,!1,null)}).fail(function(e){t.ajaxError(e)}).always(function(){$("#currentPassword").val(""),$("#newPassword").val(""),$("#confirmPassword").val(""),t.loadingRemove()});$("#change-pwd-modal").modal("hide")}})},setTaskWindow:function(){$("#open-task-modal").click(function(e){$("#task-modal").modal("show"),t.tasks.init()})},translate:function(){var e=t.locale.toLowerCase();"en-us"!==e&&"pt-br"!==e&&"es-ar"!==e&&(t.locale="pt-BR"),i18next.use(i18nextXHRBackend).init({lng:t.locale,load:"currentOnly",fallbackLng:!1,backend:{loadPath:"/locales/{{lng}}/translation.json"},useCookie:!0,getAsync:!1},function(e,a){jqueryI18next.init(i18next,$,{tName:"t",i18nName:"i18n",handleName:"localize",selectorAttr:"data-i18n",targetAttr:"i18n-target",optionsAttr:"i18n-options",useOptionsAttr:!1,parseDefaultValueFromContent:!0}),$("body").localize().show(),"dashboard"===t.action&&$("#calendar").fullCalendar("render"),$("head").localize().show(),$.datepicker.regional[t.locale]={closeText:$.t("datepicker.closeText"),prevText:$.t("datepicker.prevText"),nextText:$.t("datepicker.nextText"),currentText:$.t("datepicker.currentText"),monthNames:[$.t("datepicker.monthNames.january"),$.t("datepicker.monthNames.february"),$.t("datepicker.monthNames.march"),$.t("datepicker.monthNames.april"),$.t("datepicker.monthNames.may"),$.t("datepicker.monthNames.june"),$.t("datepicker.monthNames.july"),$.t("datepicker.monthNames.august"),$.t("datepicker.monthNames.september"),$.t("datepicker.monthNames.october"),$.t("datepicker.monthNames.november"),$.t("datepicker.monthNames.december")],monthNamesShort:[$.t("datepicker.monthNamesShort.january"),$.t("datepicker.monthNamesShort.february"),$.t("datepicker.monthNamesShort.march"),$.t("datepicker.monthNamesShort.april"),$.t("datepicker.monthNamesShort.may"),$.t("datepicker.monthNamesShort.june"),$.t("datepicker.monthNamesShort.july"),$.t("datepicker.monthNamesShort.august"),$.t("datepicker.monthNamesShort.september"),$.t("datepicker.monthNamesShort.october"),$.t("datepicker.monthNamesShort.november"),$.t("datepicker.monthNamesShort.december")],dayNames:[$.t("datepicker.dayNames.sunday"),$.t("datepicker.dayNames.monday"),$.t("datepicker.dayNames.tuesday"),$.t("datepicker.dayNames.wednesday"),$.t("datepicker.dayNames.thursday"),$.t("datepicker.dayNames.friday"),$.t("datepicker.dayNames.saturday")],dayNamesShort:[$.t("datepicker.dayNamesShort.sunday"),$.t("datepicker.dayNamesShort.monday"),$.t("datepicker.dayNamesShort.tuesday"),$.t("datepicker.dayNamesShort.wednesday"),$.t("datepicker.dayNamesShort.thursday"),$.t("datepicker.dayNamesShort.friday"),$.t("datepicker.dayNamesShort.saturday")],dayNamesMin:[$.t("datepicker.dayNamesMin.sunday"),$.t("datepicker.dayNamesMin.monday"),$.t("datepicker.dayNamesMin.tuesday"),$.t("datepicker.dayNamesMin.wednesday"),$.t("datepicker.dayNamesMin.thursday"),$.t("datepicker.dayNamesMin.friday"),$.t("datepicker.dayNamesMin.saturday")],weekHeader:$.t("datepicker.weekHeader"),dateFormat:$.t("datepicker.dateFormat"),firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},$.datepicker.setDefaults($.datepicker.regional[t.locale]),$(".datepicker").datepicker({yearRange:"1754:9998"}),$(".datepicker").after('<span class="input-tooltip icon icon-calendar-2"></span>'),$(".datepicker").parent().css("position","relative"),t.setPath(),t.highlightMenu()})},changeLanguage:function(e){t.locale=e,i18next.changeLanguage(t.locale,function(){$("body").localize()})},setTokens:function(e,a,o,n,r,i,s,d){localStorage.setItem("expires_in",(new Date).getTime()+1e3*r-5e3),localStorage.setItem("access_token",e),localStorage.setItem("refresh_token",a),localStorage.setItem("username",o),void 0!==d&&localStorage.setItem("acceptanceTerms",d),i&&localStorage.setItem("profile_id",i),s&&localStorage.setItem("user_id",s),t.setPropertyId(n)},setPropertyId:function(e){e&&localStorage.setItem("property_id",e)},refreshToken:function(e){refreshData={username:localStorage.getItem("username"),refresh_token:localStorage.getItem("refresh_token"),grant_type:"refresh_token",property_id:localStorage.getItem("property_id")},t.loadingAdd();$.ajax({url:t.api+"token",type:"POST",data:refreshData,async:!1,beforeSend:t.setHeaders}).done(function(a){t.setTokens(a.access_token,a.refresh_token,refreshData.username,a.property_id,a.expires_in),localStorage.setItem("last_refresh",new Date),e&&(window.location.href=e)}).fail(function(e){t.notify("error",$.t("notify.error"),$.t("error.unauthorized"),!1,t.logout)}).always(function(){t.loadingRemove()})},getRoles:function(){if("/propertyMenu.html"!==window.location.pathname&&"/entryUser.html"!==window.location.pathname){t.loadingAdd();$.ajax({url:t.api+"api/user/roles",type:"GET",async:!1,beforeSend:t.setHeaders}).done(function(e){"/entryUser.html"===window.location.pathname||"/entryProperty.html"===window.location.pathname||e?e||"1"!==localStorage.getItem("profile_id")&&(window.location.href="home.html"):($("#user-link").remove(),"1"!==localStorage.getItem("profile_id")&&$('a[href="entryProperty.html"]').parent().remove())}).fail(function(e){t.ajaxError(e)}).always(function(){t.loadingRemove()})}},setHeaders:function(e,a){-1===a.url.indexOf("token")&&(new Date).getTime()>=localStorage.getItem("expires_in")&&t.refreshToken(),e.setRequestHeader("Authorization","Bearer "+localStorage.getItem("access_token")),e.setRequestHeader("Accept-Language",t.locale)},logout:function(e){var t=window.localStorage.getItem("acceptanceTerms");localStorage.clear(),window.localStorage.setItem("acceptanceTerms",isNaN(t)?"0":t),window.location.href="/"},bindLogout:function(e){$("#logout").click(t.logout)},htmlEncode:function(e){return e?String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""},ajaxError:function(e){t.loadingRemove(),0===e.status?t.notify("error",$.t("notify.error"),$.t("error.noConnection")):401===e.status?t.refreshToken():504===e.status?t.notify("error",$.t("notify.error"),$.t("error.timeout")):e.responseText?t.notify("error",$.t("notify.error"),e.responseText):t.notify("error",$.t("notify.error"),$.t("error.ajaxError"))},getDateTime:function(e,t,a){var o=a||"YYYY-MM-DD";if(t=t||"DD/MM/YYYY",!e)return"";var n=e.split("T");return"split"===t?n[0]:"datepicker"===t?new moment(n[0],o)._d:1===n.length?new moment(n[0],o).format(t):(o=a||"YYYY-MM-DD HH:mm:ss",-1===n[1].indexOf("-")?new moment(n[0]+" "+n[1],o).format(t):new moment(n[0]+" "+n[1].split("-")[0],o).format(t))},isMobile:function(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Windows Phone|Opera Mini/i.test(navigator.userAgent)},getOrientation:function(){return window.innerHeight>window.innerWidth?"portrait":"landscape"},adjustScreen:function(){t.isMobile()&&($(".white").addClass("white-mobile"),$(".hidden-sm, .hidden-xs").addClass("hidden"),"landscape"===t.getOrientation()?$(".hidden-lg").removeClass("hidden-md"):$(".hidden-lg").addClass("hidden-md"))},toggleSidebar:function(){$(".main-hamburger").toggleClass("active"),$(".sidebar").toggleClass("active"),$(".main-hamburger").blur()},toggleSidebarCollapse:function(e){$($(e.firstElementChild).children()[2]).toggleClass("active")},getUrlParam:function(e){for(var t=window.location.search.substring(1).split("&"),a=0;a<t.length;a++){var o=t[a].split("=");if(o[0]===e)return o[1]}},loadingAdd:function(){$("body").css("opacity",.6),$("body").prepend('<div class="loading-div"></div>')},loadingRemove:function(){$(".loading-div").remove(),$("body").css("opacity",1)},notify:function(e,t,a,o,n){$("#notify-modal").length&&($("#notify-modal").remove(),$(".modal-backdrop").remove());var r='<div class="modal fade" id="notify-modal"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h4 class="modal-title"></h4></div><div class="modal-body"></div><div class="modal-footer"><button type="button" data-dismiss="modal" class="btn btn-default" id="btn-false">'+$.t("notify.no")+'</button><button type="button" data-dismiss="modal" class="btn btn-primary" id="btn-true">'+$.t("notify.yes")+"</button></div></div></div></div>";$("body").append(r),$("#notify-modal").modal("show"),o?($("#btn-false").show(),$("#btn-true").text($.t("notify.yes"))):($("#btn-false").hide(),$("#btn-true").text($.t("notify.ok"))),$("#notify-modal").removeClass("success error warning").addClass(e),$("#btn-true").removeClass("btn-primary btn-success btn-error btn-warning").addClass("btn-"+e),$("#notify-modal .modal-body").html(a),$("#notify-modal .modal-title").html(t),$("#notify-modal").on("shown.bs.modal",function(){$("#btn-true").focus()}),$("#btn-false").click(function(){$("#notify-modal").off("hidden.bs.modal").on("hidden.bs.modal",function(e){n&&n(!1)})}),$("#btn-true").click(function(){$("#notify-modal").off("hidden.bs.modal").on("hidden.bs.modal",function(e){n&&n(!0)})}),$("#notify-modal").off("hidden.bs.modal").on("hidden.bs.modal",function(){"none"===$("#btn-false").css("display")?n&&n(!0):n&&n(!1)})},highlightMenu:function(){setTimeout(function(){var e,t,a=window.location.href.split("/");return a=a[a.length-1],e=$(".sidebar__menu").find('a[href="'+a+'"]'),!(a.indexOf("home")>=0)&&(!(a.indexOf("dashboard")>=0)&&(!(a.indexOf("calendar")>=0)&&(t=$(e).parent().attr("id"),$("a[href='#"+t+"']").find("a,span").css("color","#34c3ce"),void $("a[href='#"+t+"']").find("a,i").css("color","#34c3ce"))))},2e3)},init:function(){console.log("app.js"),t.translate(),setTimeout(function(){var e=window.localStorage.getItem("prop-total");if(!isNaN(e)&&1==parseInt(e)){var t=$("#property-name").parent().parent().find("span p:first-child").html();$("#property-name").parent().parent().find("a").remove(),$(".top-bar__property-name").append($("<span>"+t+"</span>"))}},2e3),$("#navbar").load("./navbar.html",function(){document.getElementById("imglogo").addEventListener("load",function(){"4"===localStorage.getItem("property_id")||"12"===localStorage.getItem("property_id")||"14"===localStorage.getItem("property_id")?$("#imglogo").attr("src","images/securitas_logo_2.png"):$("#imglogo").attr("src","images/logo.png")})})}};t.init()}$(initPage);