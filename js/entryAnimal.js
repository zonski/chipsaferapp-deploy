var app,table,id=0,entry="animal",setup={deviceList:[],bindActions:function(){$(".entry-action").click(function(){switch($(this).data("action")){case"addOpen":render.switchTop();break;case"addCancel":render.switchTop(),setup.setSelectValue(!1),setup.showOption(id,!0),$("#animalStatus").prop("disabled",!1),id=0;break;case"submit":entryUtil.validateFields("#entry-add")&&entryUtil.entryCrud(entry,"submit","","#entry-add");break;default:console.log("Entry Action UNDEFINED")}}),$(".group-action").click(function(){switch($(this).data("action")){case"addOpen":render.switchTop(void 0,void 0,"#group-add");break;case"addCancel":render.switchTop(void 0,void 0,"#group-add"),setup.setSelectValue(!0);break;case"submit":entryUtil.validateFields("#group-add")&&app.notify("warning",$.t("notify.warning"),$.t("entry.saveConfirm",{entry:$.t("animal.groupName")}),!0,function(e){e&&entryUtil.entryCrud(entry,"submit","","#group-add","animal/postgroup")});break;default:console.log("Entry Action UNDEFINED")}})},bindTableActions:function(){$(".table-action").click(function(){switch($(this).data("action")){case"edit":id=$(this).data("id"),setup.showOption(id,!1),entryUtil.entryCrud(entry,"get",$(this).data("id"),"#entry-add");break;case"delete":var e=$(this).data("id");app.notify("warning",$.t("notify.warning"),$.t("entry.deleteConfirm",{entry:$.t(entry+".name")}),!0,function(t){t&&entryUtil.entryCrud(entry,"delete",e)});break;default:console.log("Table Action UNDEFINED")}})},tableSetup:function(){var e=[{data:"id",responsivePriority:1,visible:!1,render:function(e){return app.htmlEncode(e)}},{data:"code",responsivePriority:3,render:function(e){return e?app.htmlEncode(e):"-"}},{data:"nickName",responsivePriority:4,render:function(e){return e?app.htmlEncode(e):"-"}},{data:"device.code",responsivePriority:5,render:function(e){return e?app.htmlEncode(e):"-"}},{data:"gender",responsivePriority:7,render:function(e){return 1===e?$.t("animal.fields.genderMale"):2===e?$.t("animal.fields.genderFemale"):"-"}},{data:"classification.label",responsivePriority:11,render:function(e){return e?app.htmlEncode(e):"-"}},{data:"subSpecies.name",responsivePriority:8,render:function(e){return e?app.htmlEncode(e):"-"}},{data:"pelage.name",responsivePriority:9,visible:!1,render:function(e){return e?app.htmlEncode(e):"-"}},{data:"dateBirth",responsivePriority:10,render:function(e){return e?app.htmlEncode(app.getDateTime(e)):"-"}},{data:"lot.name",responsivePriority:12,render:function(e){return e?app.htmlEncode(e):"-"}},{data:"mother",responsivePriority:13,visible:!1,render:function(e){return e?e.nickName?app.htmlEncode(e.code+" - "+e.nickName):app.htmlEncode(e.code):"-"}},{data:"father",responsivePriority:14,visible:!1,render:function(e){return e?e.nickName?app.htmlEncode(e.code+" - "+e.nickName):e.code:"-"}},{data:"weight",responsivePriority:15,render:function(e){return e?app.htmlEncode(e):"-"}},{data:"animalStatus.label",responsivePriority:6,render:function(e){return e?app.htmlEncode(e):"-"}},{data:null,responsivePriority:2,render:function(e){return render.renderActions(e.id,e.id,e.locked)}}];entryUtil.tableLoad(e,!0)},createDropdownMenu:function(){var e='<ul class="dropdown-menu pull-right" role="menu" aria-labelledby="showHideColumns">';e+='<li><label id="column-label" cols="10" limit="11">'+$.t("animal.columns",{cols:"10"})+"</label></li>",e+='<li><a class="toggle-vis"><input type="checkbox" data-column="0" checked>'+$.t("animal.fields.code")+"</a></li>",e+='<li><a class="toggle-vis"><input type="checkbox" data-column="2" checked/>'+$.t("animal.fields.nickName")+"</a></li>",e+='<li><a class="toggle-vis"><input type="checkbox" data-column="3" checked/>'+$.t("animal.fields.deviceCode")+"</a></li>",e+='<li><a class="toggle-vis"><input type="checkbox" data-column="4" checked/>'+$.t("animal.fields.gender")+"</a></li>",e+='<li><a class="toggle-vis"><input type="checkbox" data-column="5" checked/>'+$.t("animal.fields.classification")+"</a></li>",e+='<li><a class="toggle-vis"><input type="checkbox" data-column="6" checked/>'+$.t("animal.fields.subspecies")+"</a></li>",e+='<li><a class="toggle-vis"><input type="checkbox" data-column="7" />'+$.t("animal.fields.pelage")+"</a></li>",e+='<li><a class="toggle-vis"><input type="checkbox" data-column="8" checked/>'+$.t("animal.fields.dateBirth")+"</a></li>",e+='<li><a class="toggle-vis"><input type="checkbox" data-column="9" checked/>'+$.t("animal.fields.lot")+"</a></li>",e+='<li><a class="toggle-vis"><input type="checkbox" data-column="10" />'+$.t("animal.fields.mother")+"</a></li>",e+='<li><a class="toggle-vis"><input type="checkbox" data-column="11"/>'+$.t("animal.fields.father")+"</a></li>",e+='<li><a class="toggle-vis"><input type="checkbox" data-column="12" checked/>'+$.t("animal.fields.weight")+"</a></li>",e+='<li><a class="toggle-vis"><input type="checkbox" data-column="13" checked/>'+$.t("animal.fields.animalStatus")+"</a></li>",e+="</ul>",$("#showHideColumns").wrap('<div id="columnsDropdown-div" class="dropdown show"></div>'),$("#columnsDropdown-div").append(e),$(".dropdown-menu").on("click",function(e){e.stopPropagation()}),$("#columnsDropdown-div a.toggle-vis").on("click",function(e){var t=parseInt($("#column-label").attr("cols")),i=parseInt($("#column-label").attr("limit")),a=$(this).find("input:checkbox").is(":checked");$(e.target).is("input")&&(a=!a),a?t-=1:t+=1;var n=$(this).find("input:checkbox").attr("data-column");t<=i?($("#column-label").attr("cols",t),$("#column-label").text($.t("animal.columns",{cols:t})),table.column(n).visible(!a),$(this).find("input:checkbox").prop("checked",!a)):$(e.target).is("input")&&$(this).find("input:checkbox").prop("checked",a)})},setSelectValue:function(e){e?($("#genderGroup").val("1").change(),$("#subspeciesGroup").val("10").change()):($("#gender").val("1").change(),$("#subspecies").val("10").change())},populateSelects:function(){$("#subspecies").on("change",function(e){entryUtil.populateSelect("pelage",["name"],!0,"/getbysubspecies/"+this.value,void 0,void 0,!1,$.t("select.notSelected"),!1)}),$("#subspeciesGroup").on("change",function(e){entryUtil.populateSelectWithSpecifiedComboData("pelage","pelageGroup",["name"],!0,"/getbysubspecies/"+this.value,void 0,void 0,!1,$.t("select.notSelected"),!1)}),$("#gender").on("change",function(e){entryUtil.populateSelect("classification",["label"],!1,"/getallbygender/"+this.value)}),$("#genderGroup").on("change",function(e){entryUtil.populateSelectWithSpecifiedComboData("classification","classificationGroup",["label"],!1,"/getallbygender/"+this.value)}),entryUtil.populateSelect("classification",["label"],!1,"/getallbygender/"+$("#gender").val()),entryUtil.populateSelect("subspecies",["name"],!1,"/getidname/"),entryUtil.populateSelect("animalStatus",["label"],!1,"/getall/true",void 0,void 0,void 0,void 0,void 0,!0),entryUtil.populateSelectWithSpecifiedComboData("animalStatus","animalStatusGroup",["label"],!1,"/getall/true",void 0,void 0,void 0,void 0,void 0,!0),entryUtil.populateSelectWithSpecifiedComboData("animal","father",["code","nickName"],!0,"/getall/male",void 0,void 0,!1,$.t("select.notSelected")),entryUtil.populateSelectWithSpecifiedComboData("animal","mother",["code","nickName"],!0,"/getall/female",void 0,void 0,!1,$.t("select.notSelected")),$("#genderGroup").val("1").change(),setup.populateDeviceSelect(),$("#animalStatus").children('option[value="4"]').attr("disabled",!0),$("#animalStatus").children('option[value="7"]').attr("disabled",!0),$("#animalStatusGroup").children('option[value="4"]').attr("disabled",!0),$("#animalStatusGroup").children('option[value="7"]').attr("disabled",!0)},showOption:function(e,t){if(0!=e){var i,a=deviceList.length;for(i=0;i<a;i++)deviceList[i].animalId==e&&$("#device > option").each(function(){var e=$(this);e[0].value==deviceList[i].id&&(e[0].hidden=t)})}},populateDeviceSelect:function(){var e=!1;$("#device").empty().append('<option value="0">'+$.t("animal.fields.noDeviceAssociated")+"</option>"),entryUtil.getJsonData("device/getAllAnimalAssociated/","GET").then(function(t){deviceList=t,$.each(t,function(t,i){e=i.animalId>0,$(".row-profile").find("select").append($("<option>",{value:i.id,text:i.code,hidden:e}))})})},init:function(e){console.log("entryAnimal.js"),document.title=$.t("animal.title"),app=e,this.bindActions(),this.populateSelects(),this.tableSetup()}};