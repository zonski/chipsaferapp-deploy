var app,setup={bindActions:function(){$("#back-taskEvent-btn").click(function(){var e=app.getUrlParam("date");window.location.href=e?"taskEvent.html?date="+e:"taskEvent.html"}),$("#status").change(function(){var e=$(this).data("id"),t=$(this).prop("checked"),a=t?"Done":"Created";app.loadingAdd();$.ajax({url:app.api+"api/taskevent/status/"+e+"/"+a,type:"PUT",beforeSend:app.setHeaders}).done(function(e){app.notify("success",$.t("notify.success"),$.t("entry.putMsg",{entry:$.t("taskEvent.fields.status")}),!1)}).fail(function(e){$("#status").prop("checked",!t),app.ajaxError(e)}).always(function(){app.loadingRemove()});console.log()}),$(".entry-action").click(function(){switch($(this).data("action")){case"submit":if(entryUtil.validateFields("#formSpecificEventBase")){var e=entryUtil.buildEntryJson("#formSpecificEventBase");1==$("#inputType").data("inputType")&&(e.animal={},e.animal.id=$("#animalId-inputTypeAnimal").val()),app.loadingAdd();$.ajax({url:app.api+"api/taskevent/weighing",type:"POST",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",beforeSend:app.setHeaders}).done(function(t){app.notify("success",$.t("notify.success"),$.t("entry.postMsg",{entry:$.t("taskEvent.fields.weight")}),!1),entryUtil.clearAdd("#formSpecificEventBase"),$("#animalId-inputTypeAnimal").val(e.animal.id)}).fail(function(e){app.ajaxError(e)}).always(function(){app.loadingRemove()})}break;default:console.log("Entry Action UNDEFINED")}})},populateView:function(){var e=app.getUrlParam("id");app.loadingAdd();$.ajax({url:app.api+"api/taskevent/"+e,type:"GET",beforeSend:app.setHeaders}).done(function(e){$("#taskEvent").removeClass("hidden");for(var t=1;t<6;t++)$("#taskEvent .taskEventGroup").removeClass("type"+t);if($("#taskEvent .taskEventGroup").addClass("type"+e.eventDay.event.eventType.eventTypeFather.id),$("#title-taskEvent").html(app.htmlEncode(e.eventDay.event.eventType.name)),e.eventTaskDescription=e.eventTaskDescription.replace(/\n/g,"<br/>"),$("#description").html(e.eventTaskDescription),$("#duration").html(app.getDateTime(e.startDateTime,"HH:mm")+" - "+app.getDateTime(e.endDateTime,"HH:mm")),0!==e.eventDay.event.eventType.specificEvent){if($("#formSpecificEventBase").show(),1===e.eventDay.event.eventType.specificEvent?$("#formWeighing").show():$("#formWeighing").hide(),2===e.eventDay.event.inputType)setup.populateAutoComplete(e.eventDay.event.lot.id),$("#inputType").html($.t("event.fields.bylot")),$("#inputName").html(e.eventDay.event.lot.name),$("#formAnimal").show(),$("#inputType").data("inputType",2);else if(1===e.eventDay.event.inputType){$("#inputType").html($.t("event.fields.byanimal"));var a="";e.eventDay.event.animal.code&&(a+=e.eventDay.event.animal.code),e.eventDay.event.animal.nickName&&(a=a+" - "+e.eventDay.event.animal.nickName),$("#inputName").html(a),$("#animalId-inputTypeAnimal").val(e.eventDay.event.animal.id),$("#formAnimal").hide(),$("#inputType").data("inputType",1)}}else $("#formSpecificEventBase").hide();"Done"===e.status?$("#status").prop("checked",!0):$("#status").prop("checked",!1),$("#status").data("id",e.id)}).fail(function(e){app.ajaxError(e)}).always(function(){app.loadingRemove()})},populateAutoComplete:function(e){entryUtil.populateInput("animal",["code","nickName"],"/getByLotId/"+e,"#formAnimal","animal","event.fields.animal")},init:function(e){console.log("taskEvent.js"),app=e,this.bindActions(),this.populateView()}};